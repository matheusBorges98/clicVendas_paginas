<!DOCTYPE html>  
<html ng-app="appV2">  
<head> 
	<meta charset="utf 8">
<!-- Imports CSS-->
	<link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/bootstrap.min.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/jquery.dataTables.min.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/angular-datatables.min.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/dataTables.colVis.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/dataTables.tableTools.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/buttons.dataTables.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/datatables.bootstrap.min.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/isteven-multi-select.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/font-awesome/css/all.min.css">
    <link rel="stylesheet" href="http://sistema.clicvenda.com.br/clicVendas/plugins/angCSS/buttons.dataTables.min.css">
<!-- Imports CSS-->

<!-- View --> 
</head>  
<body>
	<div>
		<div ng-controller="PedidoV2Ctrl">
			<div ng-repeat="doc in listaDocs">
				<div>{{doc.desPro}}</div>
			</div>
		</div>

		<div ng-controller="ColunasController">
			
			<h5>{{message}}</h5>
		</div>
	</div>
<!-- View --> 

<!-- Scripts importados -->
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/jquery-3.1.1.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/easytimer.min.js"></script>	
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-route.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-ui-router.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-cookies.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angular-ui-notification/angular-ui-notification.min.js"></script>  
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/ui-bootstrap-tpls-2.5.0.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/dist/jquery.dataTables.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/dist/angular-datatables.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/bootstrap.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-datatables.bootstrap.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-datatables.factory.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-datatables.options.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/dataTables.buttons.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/buttons.colVis.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/buttons.flash.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/buttons.html5.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/buttons.print.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-datatables.buttons.min.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-locale_pt-br.js"></script>
	<script src="http://sistema.clicvenda.com.br/clicVendas/plugins/angJS/angular-sanitize.min.js"></script>
<!-- Scripts importados -->	
</body>  
</html>

<!-- Regra de negócio -->
<script>	
	(function () {
		'use strict';
		angular
			.module("appV2",['ngRoute', 'datatables']);

			var app = angular.module('appV2');

			app.controller("PedidoV2Ctrl", PedidoV2Ctrl);
			function PedidoV2Ctrl($scope, $http, $rootScope) {  
								
				$scope.executaRequisicaoExterna = async ($json) => {
					try{
						let response = await $http.post(parent.dadosUserLogado().cContextIntegracao + '/rest/Listas/executarRequisicaoExterna', $json);
						
						return response.data;
					}catch(response){
						SrvMsg.geraMensagem("erro", "Não foi possível completar a requisição. Por favor, tente novamente mais tarde.");
					}
				};
				
				/*Irá retornar os documentos para o usuario - EX: Pedidos
					Funcionalidade: Chama 'executarRequisicaoExterna', passando o json esperado pela regra;
					------
					View: $scope.listaDocs - Listagem de documentos, EX: Pedidos
				*/
				const getListaDocumentos = async () =>{
					
					let result = await $scope.executaRequisicaoExterna(
					{
						idCvtccnpj	: parent.dadosUserLogado().cId,
						numreg		: 750, 
						pRotina		: "listarProdutoB2B",
						pCodCli     : parent.dadosUserLogado().rId,
						pNomPro     : "",
						pTipPro     : "",
					});

					console.log(result);
					$scope.listaDocs = result;
					$scope.$apply();
				};
				getListaDocumentos();
				
			};

			app.controller("ColunasController", ColunasController);
			function ColunasController($scope, $rootScope, $compile,  $http, $timeout){
				
				


				$scope.message = "Controller colunas";
			};
	})();
</script> 